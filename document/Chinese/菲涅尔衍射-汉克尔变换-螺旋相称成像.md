菲涅尔衍射-汉克尔变换-螺旋相称成像

菲涅尔衍射成像过程：
$$
u_1(x_1,y_1)=-\frac i \lambda \iint_{-\infty}^{\infty}u_0(x_0,y_0)\frac {e^{ikR}} Rdx_0dy_0\\
R^2=(x_1-x_0)^2+(y_1-y_0)^2+u^2=\rho^2+u^2\\
R=\sqrt{\rho^2+u^2}=u\sqrt{(\frac \rho u)^2+1}=u+\frac {\rho^2} {2u}\\
\hat u_1(x_1,y_1)=u_1(x_1,y_1)e^{-\frac {ik(x_1^2+y_1^2)} {2f} }\\
u_1(x_1,y_1)=-\frac {ie^{iku}} {\lambda u} \iint_{-\infty}^{\infty}u_0(x_0,y_0)
e^{\frac {ik\rho^2} {2u}} dx_0dy_0\\
\rho^2=(x_1-x_0)^2+(y_1-y_0)^2=x_1^2+y_1^2+x_0^2+y_0^2-2x_1x_0-2y_1y_0\\
u_1(x_1,y_1)=-\frac {ie^{iku}} {\lambda u} e^{\frac {ik(x_1^2+y_1^2)} {2u}}\iint_{-\infty}^{\infty}u_0(x_0,y_0)e^{\frac {ik(x_0^2+y_0^2)} {2u}}
e^{-i2\pi(x_0 \frac{x_1}{\lambda u}+y_0\frac {y_1} {\lambda u})}dx_0dy_0\\
g(x_0,y_0)=u_0(x_0,y_0)e^{\frac {ik(x_0^2+y_0^2)} {2u}}\\
u_1(x_1,y_1)=-\frac{ie^{iku}}{\lambda u}e^{\frac {ik(x_1^2+y_1^2)} {2u}}G(\frac{x_1}{\lambda u},\frac{y_1}{\lambda u})\\
\hat u_1(x_1,y_1)=u_1(x_1,y_1)e^{-\frac{ik(x_1^2+y_1^2)}{2f}}\\
u_2(x_2,y_2)=-\frac{ie^{ikv}}{\lambda v}e^{\frac{ik(x_2^2+y_2^2)}{2v}}\iint_{-\infty}^\infty\hat u_1(x_1,y_1)e^{\frac{ik(x_1^2+y_1^2)}{2v}}G(\frac {x_1} {\lambda u},\frac {y_1}{\lambda u})e^{-i2\pi(x_1\frac{x_2}{\lambda v}+y_1\frac{y_2}{\lambda v})}dx_1dy_1\\
=-\frac 1 {\lambda^2}\frac{e^{ik(u+v)}}{uv}e^{\frac{ik(x_2^2+y_2^2)}{2v}}\iint_{-\infty}^{\infty}e^{\frac{ik(x_1^2+y_1^2)}2(\frac1u+\frac1v-\frac1f)}...dx_1dy_1\\
\frac 1 u+\frac 1 v=\frac 1 f\\
u_2(x_2,y_2)=-\frac u ve^{ik(u+v)}e^{\frac{ik(x_2^2+y_2^2)}{2v}}\iint_{-\infty}^{\infty}G(\frac {x_1} {\lambda u},\frac {y_1}{\lambda u})e^{-i2\pi(\frac{x_1}{\lambda u}\frac{ux_2}{v}+\frac{y_1}{\lambda u}\frac{uy_2}{v})}d\frac{x_1}{\lambda u}d\frac{y_1}{\lambda u}\\
=-\frac u ve^{ik(u+v)}e^{\frac{ik(x_2^2+y_2^2)}{2v}}g(-\frac u v x_2,-\frac u v y_2)
$$
笛卡尔坐标系下二维傅里叶变换
$$
F(\xi.\eta)=\iint_{-\infty} ^\infty f(x,y)e^{-i2\pi(x\xi+y\eta)}dxdy\\
f(x,y)=\iint_{-\infty}^\infty F(\xi,\eta)e^{i2\pi(\xi x+\eta y)}d\xi d\eta\\
f(x,y)\leftrightarrow F(\xi,\eta)\\
F(\xi,\eta)\leftrightarrow f(-x,-y)\\
$$
汉克尔变换:
$$
J_n(x)=\frac 1 {2\pi}\int_{-\pi}^\pi e^{i(n\theta-xsin\tau)}d\theta\\
\text{n阶汉克尔变换：}\\
F(\rho)=\mathcal H_n(f(r))=\int _0 ^ \infty {f(r)rJ_n(\rho r)dr}\\
\text{n阶汉克尔逆变换：}\\
f(r)=2\pi\int _0 ^ \infty {F(\rho)\rho J_n(2\pi\rho r)d\rho}
$$
极坐标下二维傅里叶变换（汉克尔变换应用）:
$$
F(\xi,\eta)=\iint_{-\infty} ^\infty f(x,y)e^{-i(x\xi+y\eta)}dxdy\\
\text{令}x=rcos\theta,y=rsin\theta,u=\rho cos\phi,v=\rho sin \phi\\
F(\rho,\phi)=\int_0^ {2\pi} d\theta\int_0^{\infty}f(r,\theta)re^{-i\rho rcos(\theta-\phi)}dr\\
f(r,\theta)\text{对}\theta\text{展开：}\\
f(r,\theta)=\sum_{n=-\infty}^\infty f_n(r)e^{in\theta}\\
\text{其中}f_n(r)=\frac 1 {2\pi}\int_0^{2\pi}f(r,\theta)e^{-in\theta}d\theta\\
F(\rho,\phi)=\sum_{n=-\infty}^\infty\int_0^{\infty}f_n(r)rdr\int_0^ {2\pi}e^{in\theta-i\rho rcos(\theta-\phi)} d\theta\\
=\sum_{n=-\infty}^\infty e^{in\phi}i^{-n}\int_0^{\infty}f_n(r)rdr\int_0^ {2\pi}e^{in(\theta-\phi+\frac \pi 2)-i\rho rsin(\theta-\phi+\frac \pi 2)} d(\theta-\phi+\frac \pi 2)\\
J_n(x)=\frac 1 {2\pi}\int_{-\pi}^\pi e^{i(n\theta-xsin\tau)}d\theta\\
F(\rho,\phi)=2\pi\sum_{n=-\infty}^\infty i^{-n}e^{in\phi}\int_0^{\infty}f_n(r)rJ_n(\rho r)dr\\
F_n(\rho)=2\pi i^{-n}\mathcal H_n(f_n(r))=2\pi i^{-n}\int _0 ^ \infty {f_n(r)rJ_n(\rho r)dr}\\
F(\rho,\phi)=\sum_{n=0}^\infty F_n(\rho)e^{in\phi}\\
F_n(\rho)=2\pi i^{-n}\mathcal H_n(f_n(r))\\
f(r,\theta)=\sum_{n=0}^\infty f_n(r)e^{in\theta}\\
f_n(r)=\frac {i^n} {2\pi}\mathcal H_n^{-1}(F_n(\rho))
$$
螺旋相称成像:
$$
f(r,\theta)=circle(\frac r R)e^{i\theta}\\
circle(r)=
\begin{cases}
1,& r> 1\\
0,& 0 \le r\le 1
\end{cases}
\\
F(\rho,\phi)=2\pi i^{-1} \mathcal H_1(cirlce(\frac r R))\\
$$
