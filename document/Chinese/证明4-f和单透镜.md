证明4-f和单透镜

4-f：
$$
从物平面到透镜1：\\
u_1(x_1,y_1)=\frac{1}{i\lambda} \frac{e^{ikf}}{f}e^{\frac{ik(x_1^2+y_1^2)}{2f}}\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2f}}e^{\frac{ik(x_0x_1+y_0y_1)}{f}}dx_0dy_0\\
乘透镜相位e^{-\frac{ik(x_1^2+y_1^2)}{2f}}\\
从透镜1到傅里叶面：\\
u_2(x_2,y_2)\propto e^{\frac{ik(x_2^2+y_2^2)}{2f}}\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{\frac{ik(x_1^2+y_1^2)}{2f}}e^{-\frac{ik(x_1x_2+y_1y_2)}{f}}[\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2f}}e^{-\frac{ik(x_0x_1+y_0y_1)}{f}}dx_0dy_0]dx_1dy_1\\
令g(x_0,y_0)=u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2f}}\\
$$

方法一：
$$
u_2(x_2,y_2)\propto e^{\frac{ik(x_2^2+y_2^2)}{2f}}\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{\frac{ik(x_1^2+y_1^2)}{2f}}e^{-\frac{ik(x_1x_2+y_1y_2)}{f}}G(\frac{kx_1}{f},\frac{ky_1}{f})dx_1dy_1\\
=e^{\frac{ik(x_2^2+y_2^2)}{2f}}[g(-x_2,-y_2)**\mathcal{F}(e^{\frac{ik(x_1^2+y_1^2)}{2f}})](该卷积核无法求出)\\
更换思路：u_2(x_2,y_2)\propto \iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{-ik\frac{(x_1-x_2)^2+(y_1-y_2)^2}{f}}G(\frac{kx_1}{2f},\frac{ky_1}{f})dx_1dy_1\\
=g(-x_2,-y_2)**常数\\
\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{-ik\frac{(x_1-x_2)^2+(y_1-y_2)^2}{f}}dx_1dy_1=\iint_{-\frac{D_1}{2}-x_2}^{\frac{D_1}{2}-x_2}e^{-ik\frac{(x_1-x_2)^2+(y_1-y_2)^2}{f}}d(x_1-x_2)d(y_1-y_2)\\
当D_1>>D_2时积分上下边界可以认为是无穷\\
由\int_{-\infin}^{\infin}e^{ix^2}dx=\sqrt\frac{\pi}{2}(1+i)可知卷积核为常数\\
此路不通\\
$$

$$
方法二：u_2(x_2,y_2)\propto e^{\frac{ik(x_2^2+y_2^2)}{2f}}\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{\frac{ik(x_1^2+y_1^2)}{2f}}e^{-\frac{ik(x_1x_2+y_1y_2)}{f}}[\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2f}}e^{-\frac{ik(x_0x_1+y_0y_1)}{f}}dx_0dy_0]dx_1dy_1\\
交换积分顺序，先积分dx_1dy_1\\
=\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2f}}[\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{\frac{ik(x_2^2+y_2^2)}{2f}}e^{-\frac{ik(x_0x_1+y_0y_1)}{f}}e^{\frac{ik(x_1^2+y_1^2)}{2f}}e^{-\frac{ik(x_1x_2+y_1y_2)}{f}}dx_1dy_1]dx_0dy_0\\
=\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2f}}[\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{\frac{ik(x_1^2+x_2^2-2x_0x_1-2x_1x_2)}{2f}}e^{\frac{ik(y_1^2+y_2^2-2y_0y_1-2y_1y_2)}{2f}}dx_1dy_1]dx_0dy_0\\
凑成(x_1-x_0-x_2)^2形式，差一个2x_0x_2\\
=\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{-\frac{ik(x_0x_2+y_0y_2)}{f}}[\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{\frac{ik(x_1-x_0-x_2)^2}{2f}}e^{\frac{ik(y_1-y_0-y_2)^2}{2f}}dx_1dy_1]dx_0dy_0\\
\iint_{-\frac{D_1}{2}-x_0-x_2}^{\frac{D_1}{2}-x_0-x_2}e^{\frac{ik(x_1-x_0-x_2)^2}{2f}}e^{\frac{ik(y_1-y_0-y_2)^2}{2f}}d(x_1-x_0-x_2)d(y_1-y_0-y_2)\\
由\int_{-\infin}^{\infin}e^{ix^2}dx=\sqrt\frac{\pi}{2}(1+i)可知,当D_1>>D_0+D_2时积分上下界可看为无穷，并且不被x_0+x_2影响，积分结果为常数\\
u_2(x_2,y_2)\propto\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{-\frac{ik(x_0x_2+y_0y_2)}{f}}dx_0dy_0=U_0(\frac{kx_2}{f},\frac{ky_2}{f})\\
4f系统为完美的傅里叶变换
$$

单透镜：
$$
从物平面到透镜：\\
u_1(x_1,y_1)=\frac{1}{i\lambda} \frac{e^{iku}}{u}e^{\frac{ik(x_1^2+y_1^2)}{2u}}\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2u}}e^{\frac{ik(x_0x_1+y_0y_1)}{u}}dx_0dy_0\\
乘透镜相位e^{-\frac{ik(x_1^2+y_1^2)}{2f}}\\
从透镜到像面：\\
u_2(x_2,y_2)\propto e^{\frac{ik(x_2^2+y_2^2)}{2v}}\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{\frac{ik(x_1^2+y_1^2)}2(\frac 1 u+\frac 1 v -\frac{1}{f})}e^{-\frac{ik(x_1x_2+y_1y_2)}{v}}[\iint_{-\frac{D_0}{2}}^{\frac{D_0}{2}}u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2u}}e^{-\frac{ik(x_0x_1+y_0y_1)}{u}}dx_0dy_0]dx_1dy_1\\
由于成像需满足调节\frac 1 u+\frac 1 v=\frac 1 f,同时令g(x_0,y_0)=u_0(x_0,y_0)e^{\frac{ik(x_0^2+y_0^2)}{2u}}\\
u_2(x_2,y_2)\propto e^{\frac{ik(x_2^2+y_2^2)}{2v}}\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{-\frac{ik(x_1x_2+y_1y_2)}{v}}G(\frac{kx_1}{u},\frac{ky_1}{u})dx_1dy_1\\
=e^{\frac{ik(x_2^2+y_2^2)}{2v}}\iint_{-\frac{D_1}{2}}^{\frac{D_1}{2}}e^{-i(\frac{kx_1}{u}\frac{ux_2}{v}+\frac{ky_1}{u}\frac{uy_2}{v})}G(\frac{kx_1}{u},\frac{ky_1}{u})dx_1dy_1\\
=e^{\frac{ik(x_2^2+y_2^2)}{2v}}g(-\frac{ux_2}{v},-\frac{uy_2}{v})\\
单透镜成像存在缺陷像e^{\frac{ik(x_2^2+y_2^2)}{2v}}
$$
